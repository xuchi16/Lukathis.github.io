I"$<h1 id="åŠå¹´ä¸€åº¦å¼€å­¦å­£">åŠå¹´ä¸€åº¦å¼€å­¦å­£</h1>

<p>å¼€å­¦æ„å‘³ç€è¦å¼€å§‹å¿™ç¢Œèµ·æ¥äº†ï¼Œè€Œä¸€åˆ‡å¿™ç¢Œçš„èµ·å§‹æ˜¯ç»Ÿè®¡ç­çº§åŒå­¦è¿”æ ¡ã€æ³¨å†Œã€æ€æƒ³åŠ¨æ€ç­‰æƒ…å†µã€‚
è€Œéœ€è¦è¿›è¡Œå…«åå¤šäººçš„â€œåºå¤§â€ç­çº§çš„ç»Ÿè®¡ï¼Œå“ªæ€•åªè¦ç»Ÿè®¡ä¸€äº›ç®€å•çš„ä¿¡æ¯éƒ½è¦è€—è´¹é¢‡å¤šç²¾åŠ›ã€‚å¼€å­¦ç»Ÿè®¡ï¼Œä¹Ÿåªæ˜¯å…¶ä¸­ä¸€é¡¹è€Œå·²ã€‚</p>

<p>å¹¸å¥½ï¼Œé€»è¾‘å¤Ÿç®€å•ï¼Œé‚£è„šæœ¬ä¹Ÿå¤Ÿç®€å•ï¼ŒåŠ¨èµ·æ¥ã€‚</p>

<h1 id="è¦åšäº›ä»€ä¹ˆ">è¦åšäº›ä»€ä¹ˆ</h1>

<p>æˆ‘ä»¬è¦æ”¶é›†å¤§å®¶çš„ä¿¡æ¯ï¼Œå¥½æ¯”æŠŠå¤§è±¡å¡è¿›å†°ç®±ï¼Œä¸€å…±åˆ†ä¸‰æ­¥ï¼š</p>

<p>Step1. å†™ä¸€ä¸ªè‰¯å¥½çš„excelæ¨¡æ¿ï¼Œè§„è§„çŸ©çŸ©åœ°å†™å¥½ä¾‹å­ä»¥ä¾›å¤§å®¶ç…§å†™ä¸è¯¯ï¼Œè°éƒ½å–œæ¬¢æ— è„‘åŒ¹é…ä¸æ˜¯ä¹ˆã€‚</p>

<p>Step2. å‘æ”¾æ¨¡æ¿ç»™å¤§å®¶ï¼Œå¹¶æ”¶é›†å¡«å†™å®Œæˆåçš„æ–‡ä»¶ï¼ˆæœ€ç¹çä¹‹æ­¥éª¤ï¼‰</p>

<p>Step3. å†™è„šæœ¬è·‘è„šæœ¬ï¼ˆæœ€æœ‰è¶£çš„éƒ¨åˆ†ï¼‰</p>

<h1 id="ä¸Šä»£ç ">ä¸Šä»£ç </h1>

<p>ç”¨pythonå®ç°ï¼Œæ–¹ä¾¿å¿«æ·ï¼š</p>
<ul>
  <li>get_file_list(path)ï¼Œæ¥æ”¶ä¸€ä¸ªpathå‚æ•°ï¼Œè¿”å›è¯¥è·¯å¾„ä¸‹æ‰€æœ‰excelæ–‡ä»¶çš„æ–‡ä»¶åçš„é›†åˆ</li>
  <li>read_content(filepath, filename)ï¼Œè¿”å›ç›®æ ‡excelæ–‡ä»¶çš„ç¬¬ä¸€å¼ è¡¨</li>
  <li>write_content(wtable, target_row, rtable)å‘ç›®æ ‡tableä¸­æ‹·è´æºrtableçš„ç‰¹å®šè¡Œ</li>
  <li>assemble()åˆ™æ˜¯ä¸šåŠ¡é€»è¾‘ï¼Œç»„ç»‡ä»åˆ†æ•£çš„è¡¨åˆ°æœ€ç»ˆæ±‡æ€»è¡¨çš„æ˜ å°„å…³ç³»</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        import xlrd, xlwt, os

        class AssembleClient:

        def __init__(self, source_path, source_row, column_range, 
                    target_file_name="result", target_sheet_name="sheet"):
            SUFFIX = ".xls"
            self.source_path = source_path
            self.source_row = source_row
            self.column_range = column_range
            self.target_file_name = target_file_name + SUFFIX
            self.target_sheet_name = target_sheet_name

        def assemble(self):
            target =  xlwt.Workbook()
            wtable = target.add_sheet(self.target_sheet_name, cell_overwrite_ok=True)
            
            index = 0
            for filename in self.get_file_list(self.source_path):
                rtable = self.read_content(self.source_path, filename)
                self.write_content(wtable, index, rtable)
                index += 1
                
            target.save(self.target_file_name)
            print("Completed!")

        def get_file_list(self, path):
            childs = os.listdir(path)

            result = []
            for a in childs:
                if a.endswith(".xlsx") or a.endswith(".xls"):
                    result.append(a)
            return result

        def read_content(self, filepath, filename):
            fullpath = os.path.join('%s/%s' % (filepath, filename))
            source = xlrd.open_workbook(fullpath)
            rtable = source.sheets()[0]
            return rtable
            
        def write_content(self, wtable, target_row, rtable):

            if isinstance(self.column_range, int):
                column_range = list(range(0, self.column_range))
            elif isinstance(self.column_range, list):
                column_range = self.column_range

            target_index = 0
            for i in column_range:
                wtable.write(target_row, target_index, rtable.cell(self.source_row, i).value)
                target_index += 1
            return wtable

    if __name__ == "__main__":

        SOURCE_PATH = './data'
        SOURCE_ROW = 3
        COLUMN_RANGE = 10

        ac = AssembleClient(SOURCE_PATH, SOURCE_ROW, COLUMN_RANGE, "result", "sheet")
        ac.assemble()
</code></pre></div></div>

<h2 id="å°ç»“">å°ç»“</h2>

<p>ç›®å‰æ¥çœ‹ï¼Œå†™å¾—è¿˜ä¸å¤Ÿæˆç†Ÿï¼Œå¾ˆå¤šåœ°æ–¹ä¹Ÿåªæ˜¯å°±äº‹è®ºäº‹åœ°è§£å†³äº†å½“ä¸‹çš„é—®é¢˜ï¼Œåœ¨ä»¥åçš„ä½¿ç”¨ä¸­ç»§ç»­refactorï¼Œä¸æ–­å®Œå–„ã€‚</p>
:ET